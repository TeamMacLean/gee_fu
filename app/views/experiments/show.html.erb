<%- model_class = Experiment -%>
<div class="page-header">
    <h1>Experiment ID <%= @experiment.id %></h1>
</div>

<p>Enter the name of the reference sequence:</p>

<input value="<%= @seqs.first %>" id="seqname" type="text" class="span5" style="margin: 0 auto;" data-provide="typeahead" data-items="10" data-source='<%= @seqs %>'>
<a href="" id="seqsearchbutton" class="btn">Go</a>
<br>
<br>

<script type="text/javascript">
    function autoIframe(frameId) {
        alert("resizr");
        try {
            frame = document.getElementById(frameId);
            innerDoc = (frame.contentDocument) ? frame.contentDocument : frame.contentWindow.document;

            if (innerDoc == null) {
                // Google Chrome
                frame.height = document.all[frameId].clientHeight + document.all[frameId].offsetHeight +
                        document.all[frameId].offsetTop;
            }
            else {
                objToResize = (frame.style) ? frame.style : frame;
                objToResize.height = innerDoc.body.scrollHeight + 18;
            }
        }

        catch (err) {
            alert('Err: ' + err.message);
            window.status = err.message;
        }
    }
</script>

<div class="well">
    <iframe id="frame" src="" width="100%" height="420px" frameBorder="0" seamless='seamless' onload="if (window.parent && window.parent.autoIframe) {window.parent.autoIframe('frame');}"></iframe>
</div>



<script type="text/javascript">


    function goToAddress() {
        seq = $("#seqsearchbutton").val();
        if (!seq || 0 === seq.length) {
            seq = "UNKNOWN"
        }
        $("#frame").attr("src", "/features/dalliance/part/<%= @experiment.id%>/" + seq);
    }

    goToAddress();

    $("#seqsearchbutton").keyup(function () {
        goToAddress();

    });
</script>

<hr>

<dl class="dl-horizontal">
    <dt><strong><%= model_class.human_attribute_name(:name) %>:</strong></dt>
    <dd><%= @experiment.name %></dd>
    <dt><strong><%= model_class.human_attribute_name(:description) %>:</strong></dt>
    <dd><%= @experiment.description %></dd>
    <dt><strong><%= model_class.human_attribute_name(:uses_bam_file) %>:</strong></dt>
    <dd><%= @experiment.uses_bam_file %></dd>
    <% if @experiment.uses_bam_file %>
        <dt><strong><%= model_class.human_attribute_name(:bam_file_path) %>:</strong></dt>
        <dd><%= @experiment.bam_file_path %></dd>
    <% end %>
    <dt><strong>Number of features:</strong></dt>
    <dd><%= @experiment.features.count %></dd>
    <dt><strong><%= model_class.human_attribute_name(:meta) %>:</strong></dt>
    <dd><%= @experiment.html_meta %></dd>
</dl>

<div class="form-actions">
    <%= link_to t('.back', :default => t("helpers.links.back")),
                experiments_path, :class => 'btn' %>
    <%#= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_experiment_path(@experiment), :class => 'btn' %>
</div>
